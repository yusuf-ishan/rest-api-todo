var n=require("@preact/signals-core"),e=require("react"),r=require("use-sync-external-store/shim/index.js"),t=require("react/jsx-runtime"),u=require("react/jsx-dev-runtime");function i(n){return n&&"object"==typeof n&&"default"in n?n.default:n}var f=/*#__PURE__*/i(e),o=/*#__PURE__*/i(t),c=/*#__PURE__*/i(u),a=null,l=!1,s=null,v=new Map;function p(n){if(!n)return 1;var e,r=v.get(n);if(void 0!==r)return r;var t=n.useCallback.toString();if(n.useReducer===n.useEffect)e=1;else if(n.useEffect===n.useImperativeHandle)e=32;else if(/Invalid/.test(t))e=2;else if(/updateCallback/.test(t)||/\[0\]/.test(t)&&/\[1\]/.test(t)){var u=n.useReducer.toString();if(/rerenderReducer/.test(u)||/return\s*\[\w+,/.test(u))e=16;else e=8}else e=4;v.set(n,e);return e}var b=[],d=Symbol.for("react.element");function m(e){if("function"!=typeof e)return e;else return function(r,t){if("string"==typeof r&&t)for(var u in t){var i=t[u];if("children"!==u&&i instanceof n.Signal)t[u]=i.value}return e.call.apply(e,[e,r,t].concat([].slice.call(arguments,2)))}}var x,y=Symbol.dispose||Symbol.for("Symbol.dispose");function g(n){if(x)x();x=n&&n.effect.S()}var j,h=function(){return g()},q=Promise.prototype.then.bind(Promise.resolve());function S(){h();if(!j)j=q(function(){j=void 0;h()});var t=e.useRef();if(null==t.current)t.current=function(){var e,r,t,u=0,i=n.effect(function(){r=this});r.c=function(){u=u+1|0;if(t)t()};return(e={effect:r,subscribe:function(n){t=n;return function(){u=u+1|0;t=void 0;i()}},getSnapshot:function(){return u},f:function(){h()}})[y]=function(){h()},e}();var u=t.current;r.useSyncExternalStore(u.subscribe,u.getSnapshot,u.getSnapshot);g(u);return u}Object.defineProperties(n.Signal.prototype,{$$typeof:{configurable:!0,value:d},type:{configurable:!0,value:function(n){return n.data.value}},props:{configurable:!0,get:function(){return{data:this}}},ref:{configurable:!0,value:null}});exports.installAutoSignalTracking=function(){Object.defineProperty(e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher,"current",{get:function(){return s},set:function(n){if(!l){var e=p(s),r=p(n);s=n;if(function(n,e){if(1&n&&28&e)return!0;else if(2&n||2&e)return!1;else if(16&e)return!0;else return!1}(e,r)){l=!0;a=S();l=!1}else if(function(n,e){return Boolean(28&n&&1&e)}(e,r)){var t;null==(t=a)||t.f();a=null}}else s=n}});!function(){var n=o,e=c;f.createElement=m(f.createElement);e.jsx&&(e.jsx=m(e.jsx));n.jsx&&(n.jsx=m(n.jsx));e.jsxs&&(e.jsxs=m(e.jsxs));n.jsxs&&(n.jsxs=m(n.jsxs));e.jsxDEV&&(e.jsxDEV=m(e.jsxDEV));n.jsxDEV&&(n.jsxDEV=m(n.jsxDEV))}()};exports.useComputed=function(r){var t=e.useRef(r);t.current=r;return e.useMemo(function(){return n.computed(function(){return t.current()})},b)};exports.useSignal=function(r){return e.useMemo(function(){return n.signal(r)},b)};exports.useSignalEffect=function(r){var t=e.useRef(r);t.current=r;e.useEffect(function(){return n.effect(function(){return t.current()})},b)};exports.useSignals=S;exports.wrapJsx=m;//# sourceMappingURL=runtime.js.map
